(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11644,        344]
NotebookOptionsPosition[     10949,        319]
NotebookOutlinePosition[     11307,        335]
CellTagsIndexPosition[     11264,        332]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"theta12", ">", "0"}], "&&", 
     RowBox[{"theta13", ">", "0"}], "&&", 
     RowBox[{"theta23", ">", "0"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega12", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta12", "]"}], ",", 
       RowBox[{"Sin", "[", "theta12", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta12", "]"}]}], ",", 
       RowBox[{"Cos", "[", "theta12", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega13", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta13", "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], "*", "delta"}], "]"}], "*", 
        RowBox[{"Sin", "[", "theta13", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "delta"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", "theta13", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "theta13", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega23", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "theta23", "]"}], ",", 
       RowBox[{"Sin", "[", "theta23", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta23", "]"}]}], ",", 
       RowBox[{"Cos", "[", "theta23", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega12", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega13", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega23", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"omega23", ".", "omega13", ".", "omega12"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uuuu", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", "alpha", "]"}], "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}], "*", 
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"[", "beta", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"[", "alpha", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], "]"}], "*", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", "beta", "]"}], "]"}], "[", 
     RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uuuu", "//", "Expand"}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probability", "=", 
   RowBox[{
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"alpha", ",", "beta"}], "]"}], "-", 
    RowBox[{"4", "*", "uuuu"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probability", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", "True"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.733683560695319*^9, 3.7336836529817*^9}, {
   3.7337798814812107`*^9, 3.733779890057621*^9}, 3.733780198669046*^9, {
   3.733780275810919*^9, 3.7337803534256983`*^9}, {3.7337824860504827`*^9, 
   3.733782645910159*^9}, {3.733782676677339*^9, 3.733782727405304*^9}, {
   3.733782853790594*^9, 3.7337828564309177`*^9}, {3.73378300258169*^9, 
   3.733783003596315*^9}, {3.7337830498845787`*^9, 3.7337832928394327`*^9}, {
   3.733783588565073*^9, 3.733783755825547*^9}, {3.7337838694932632`*^9, 
   3.733783870789825*^9}},ExpressionUUID->"0ee3869a-cf0c-4d9d-8b5b-\
a66245226a84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Conjugate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "theta12", "]"}], " ", 
      RowBox[{"Cos", "[", "theta23", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "delta"}]], " ", 
      RowBox[{"Sin", "[", "theta12", "]"}], " ", 
      RowBox[{"Sin", "[", "theta13", "]"}], " ", 
      RowBox[{"Sin", "[", "theta23", "]"}]}]}], "]"}]}], " ", 
  RowBox[{"Cos", "[", "theta12", "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Cos", "[", "theta13", "]"}], "2"], " ", 
  RowBox[{"Sin", "[", "theta12", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "theta23", "]"}], " ", 
     RowBox[{"Sin", "[", "theta12", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "delta"}]], " ", 
     RowBox[{"Cos", "[", "theta12", "]"}], " ", 
     RowBox[{"Sin", "[", "theta13", "]"}], " ", 
     RowBox[{"Sin", "[", "theta23", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.733683654993085*^9, {3.7337826362256317`*^9, 3.733782647974943*^9}, 
   3.733782683259407*^9, 3.73378272901035*^9, 3.733782857868916*^9, {
   3.733783092796007*^9, 3.733783097863653*^9}, {3.733783266950245*^9, 
   3.733783294084996*^9}, {3.733783654311452*^9, 3.733783726476371*^9}, {
   3.733783756810701*^9, 3.733783760626001*^9}, 
   3.733783871759696*^9},ExpressionUUID->"e78e6c58-883a-4096-a0d8-\
f5ef745dbf21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{
      RowBox[{"dm2", "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", "energy"}], ")"}]}], "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "*", "theta"}], "]"}]}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", "*", "theta"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", "*", "theta"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", "*", "theta"}], "]"}]}], "}"}]}], "}"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{
      RowBox[{"dm2", "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", "energy"}], ")"}]}], "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", "*", "theta"}], "]"}]}], "+", "A"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", "*", "theta"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", "*", "theta"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", "*", "theta"}], "]"}], "-", "A"}]}], "}"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eigenVectors", "=", 
     RowBox[{"Eigenvectors", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eigenVectors", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"eigenVectors", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "h", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tan", "=", 
     RowBox[{
      RowBox[{"eigenVectors", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cot", "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"eigenVectors", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tan", "+", "cot"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"tan", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"tan", "^", "2"}]}], ")"}]}]}], "//", "Expand"}], "//", 
     "Simplify"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.73375026835581*^9, 3.733750271102428*^9}, {
   3.7337506619665747`*^9, 3.733750831684338*^9}, {3.7337510543144093`*^9, 
   3.7337511064012833`*^9}, {3.7337511430214777`*^9, 3.733751150367156*^9}, {
   3.7337521276659946`*^9, 3.733752160120818*^9}, {3.7337521944679327`*^9, 
   3.7337521959084587`*^9}, {3.7337523468842382`*^9, 3.73375235948451*^9}, 
   3.733752858754842*^9, {3.733753570605514*^9, 
   3.7337536041749687`*^9}},ExpressionUUID->"ceef1182-2d3f-4767-81b2-\
35d4eaaca85a"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"1", "+", 
    SuperscriptBox["A", "2"], "-", 
    RowBox[{"2", " ", "A", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "theta"}], "]"}]}]}]], " ", 
  RowBox[{"Csc", "[", "theta", "]"}], " ", 
  RowBox[{"Sec", "[", "theta", "]"}]}]], "Output",
 CellChangeTimes->{
  3.733750725861096*^9, {3.733750764893639*^9, 3.733750800874681*^9}, 
   3.733750832681232*^9, {3.733751075544619*^9, 3.733751108079524*^9}, 
   3.733751151119597*^9, 3.7337521614697943`*^9, 3.7337521971758137`*^9, 
   3.7337523608385572`*^9, 3.733752860720216*^9, 
   3.733753605677356*^9},ExpressionUUID->"b3fd4838-67e3-485f-bbea-\
5c5185dd36e7"]
}, Open  ]]
},
WindowSize->{1414, 603},
WindowMargins->{{Automatic, -41}, {104, Automatic}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4655, 132, 537, "Input", "ExpressionUUID" -> \
"0ee3869a-cf0c-4d9d-8b5b-a66245226a84"],
Cell[5238, 156, 1488, 36, 93, "Output", "ExpressionUUID" -> \
"e78e6c58-883a-4096-a0d8-f5ef745dbf21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6763, 197, 3498, 101, 243, "Input", "ExpressionUUID" -> \
"ceef1182-2d3f-4767-81b2-35d4eaaca85a"],
Cell[10264, 300, 669, 16, 40, "Output", "ExpressionUUID" -> \
"b3fd4838-67e3-485f-bbea-5c5185dd36e7"]
}, Open  ]]
}
]
*)

